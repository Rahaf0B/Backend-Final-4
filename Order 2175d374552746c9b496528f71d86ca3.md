# Order

**The main-Rout ⇒ Host+/order**

**ALL the following routes should start with /order**

⇒ **[http://158.176.1.165:3000](http://158.176.1.165:3000/)/order**

**The description of the parameters in the routes are in :**

[Description for the parameters and query and the body in the order routes ](Description%20for%20the%20parameters%20and%20query%20and%20the%20b%2045a5e00804834da7810b15e115939144.md)

<aside>
📢 **ALL the routes below need to send session-token in the cookies**

**example ⇒  “session-token=d7bdf711-9abe-4355-9bf0-7a377ed4f8dd”**

</aside>

---

## Add new address

method⇒ POST

```json
"/new_address"
```

send a body with the request

body ⇒

```json
{
    "first_name":"",
    "last_name":"",
    "email":"",
    "phone_number":"",
    "location":""
}
```

Response⇒

- status 500 ⇒ server error
- status 400 :
    - input validation error
- status 200 will return the id of the address

---

## Add new order

method⇒ POST

```json
"/new_order"
```

send a body with the request

body⇒

```json
{
    "payment_type":"",
    "address_id":x
}
```

change x for a number

Response⇒

- status 500 ⇒ server error
- status 400 :
    - input validation error
    - if the address id is not found ⇒ it will return ⇒ Address not found
    - if there is no products in the cart ⇒ it will return  ⇒ There is no product in your cart
- status 200 will return
    
    ```json
    {
        "date": "2024-01-29",
        "order_id": 2,
        "payment_status": true,
        "payment_type": "cache",
        "total_price": 204.65,
        "status": "processing",
        "first_name": "auth",
        "last_name": "user",
        "location": "a new location",
        "email": "authusnker1@gmail.com",
        "phone_number": 970591212356
    }
    ```
    

---

## Get User Orders

method⇒ GET

```json
"/?order_status=x"
```

change x for a number

Response⇒

- status 500 ⇒ server error
- status 400 :
    - input validation error
- status 200 will return
    
    
    ```json
    [
        {
            "date": "2024-01-29",
            "order_id": 1,
            "total_price": 540,
            "status": 1,
            "payment_status": true
        },
        {
            "date": "2024-01-29",
            "order_id": 2,
            "total_price": 204.65,
            "status": 1,
            "payment_status": true
        }
    ]
    ```
    

---

## Get the order info and product in a single order

method⇒ GET

```json
"/products/?order_id=x"
```

change x to a number

Response⇒

- status 500 ⇒ server error
- status 400 :
    - input validation error
- status 200 will return
    
    the fist index of the array is the order info and the next index array have the products in the order 
    
    ```json
    [
        [
            {
                "total_price": 204.65,
                "payment_type": "cache",
                "first_name": "auth",
                "last_name": "user",
                "email": "authusnker1@gmail.com",
                "phone_number": 970591212356,
                "location": "a new location",
                "address_id": 1
            }
        ],
        [
            {
                "product_id": 20,
                "quantity": 1,
                "name": "Box Bag",
                "price": 36,
                "sub_title": "Mini Minimalist Box Bag",
                "image": {
                    "image_id": 115,
                    "name": "product_image",
                    "url": "https://img.ltwebstatic.com/images3_pi/2022/07/25/16587419827f1e6bcc308391dfd565b421e59cf074.jpg"
                }
            },
            {
                "product_id": 21,
                "quantity": 1,
                "name": "Mini Fashionable Handbag",
                "price": 45.65,
                "sub_title": "Express Yourself: Find Your Perfect Bag Match.",
                "image": {
                    "image_id": 116,
                    "name": "main_image",
                    "url": "https://img.ltwebstatic.com/images3_spmp/2024/01/19/ad/1705597855da2bd7ce9137fc703d443eddfc03f35c.jpg"
                }
            }
          
        ]
    ]
    ```